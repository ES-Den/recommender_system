# Рекомендательная система для публикаций социальной сети
---
Перед нами классическая социальная сеть, в которой пользователи могут общаться, заводить новых друзей, присоединяться к группам, просматривать публикации в персональной ленте или ленте своих друзей. Мы заинтересованы, чтобы показанные публикации пользователям были наиболее релевантными, что увеличит вовлечение наших клиентов в социальную сеть и они будут проводить больше времени в ней.
# Задача
---
С помощью базы данных с информацией о постах, пользователях и их активности подготовить ML-модель для сервиса, чтобы обеспечить предсказание 5 наиболее реливантных публикаций для ID пользователя. 

## Использованные инструменты
* __ML модель__: CatBoostClassifier.
* __Анализ__: python, pandas, numpy, mathplotlib, seaborn, scikit-learn.
* __Feature engeneering__: scikit-learn, PCA, TfIdf, K-Means.
* __Бэкэнд-сервис__: FastApi, SQLAlchemy.



# Этапы реализации проекта
---
1. Загрузка данных из базы данных. Проведение анализа (EDA). 
Краткое описание таблиц в базе данных:
* ```user_data``` - сведения о пользователях при регистрации (id, пол, возраст, город, страна и др.).
* ```post_text_df``` - описание публикаций (id, текст, топик (тема).
* ```feed_post``` - пользовательский опыт за определенный период (id юзера, id поста, действие (лайк/просмотр).
2. Подготовка качественных признаков для обучения модели.
В рабочей директории к проекту вы можете найти JupiterNotebook __post_feature.ipynb__ , который содержит в себе обработку текста и получение текстовых признаков.
3. Выбор оптимальной модели машинного обучения. Оценка качества.
В рабочей директории к проекту вы можете найти JupiterNotebook __recom_system.ipynb__, где подробным образом отображены все этапы проекта от анализа, отбора и генерации новых признаков, выбор оптимальной модели, оценки качества.
4. Загрузка предподготовленных признаков в базу данных.
5. Написание сервиса.
__endpoint.py__  -  скрипт в рабочей директории к проекту, в котором происходят следущие этапы:
* выгрузка предподготовленных признаков для обучения модели из базы данных;
* загрузка предобученной модели;
* формирование массива признаков для модели по одному пользователю;
* получение предсказаний модели;
* выбор топ-5 с наибольшей вероятностью,
а также __schema.py__  с моделью pydentic и __requirements.txt__, содержащий необходимые библиотеки.

## Результат
- Добился заданного качества и скорости работы сервиса, что позволит рекомендовать пользователям наиболее релевантные публикации. Это увеличит их вовлеченность в социальную сеть и они будут проводить больше времени в ней.

